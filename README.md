# SCADA-Forensics
This is a two state automaton or agent. It constantly monitors the growth on the SCADA tags file and fetches the new records whenever they come in. After stripping out the data from the SCADA tag string it evaluates the Tolerance for the Sensor Measurement Range. If a read is detected to be above the normal range, the agent automatically switch to Forensic mode and initiate the logging of forensic information. It uses a separate file to continuously dump the abnormal lectures from the SCADA tags and creates a record of this event appending all the information available about the system state: CPU load, sensor names, sensor values, state of the physical memory, state of the virtual memory, state of the networking variables, state of mounted disk and network drives, list of active process in memory including name, executable name, working directory, command line, user name, user ids and group ids, threads, connections, file descriptors. The information logged is exclusively for the period of time of the anomaly. Once the system start reading normal values, it switches back to Forensic Monitor and stop de logging. This guaranteed that the information captured during the event is 100% related to duration of the failure.

Forensic information can be found on the file data\ForensicLog.txt SCADA system components can be found running on legacy hardware and operating systems. In such cases, a SCADA system provides limited system resources for data acquisition and therefore demands lightweight data acquisition tools for SCADA systems. The experimental scenario was set
up using a personal computer with an i3 Intel processor, 8GB RAM and 500GB HD at 7200RPM. During the experiments the computer resources where exclusively dedicated to the simulation. The purpose was to leave, to the maximum extent possible, all systems resources available for the forensic sensing and logging procedure. Experiment recording can be seen online at the following web link: http://youtu.be/iLZEplZtaNk

The observed behavior, represented on figures 3 and 4, demonstrated that this tool does not perform exhaustive use of computing resources. During monitoring mode, the processor usage oscillated between 1% and 6% and went up to 28% during Forensic Logging. The physical memory usage did not show significant difference during both stages. It maximum usage did not exceed the 29% of the total available memory. It can be inferred that acquisition of forensic data per se might not have a significant impact in the context of modern computer resource configuration.

Another observation found on during experimentation is that data gathering process might not represent a large resource consumer. However the data conversion process, if a relational database would be implemented for a better data analysis, does requires more hardware to reduce the processing time and speed up files conversion and querying processes. Another important aspect from this experiment that would be suitable for further development is that current forensic analysis tools do not provide a standard support for the variety of SCADA hardware versions, protocols and log formats. Therefore, we have an interesting opportunity to expand this experiment with the
development of plugins and applications and interface layers in order to increase the number of SCADA forensic tools.

In conclusion, future work leads to the creation of a high level software application capable of detecting critical situations like abnormal changes of sensor reads, illegal penetrations, failures, physical memory content and abnormal traffic over the communication channel. One of the main challenges is to achieve the development of a tool that has minimal impact over the SCADA resources, during the data acquisition process. In the present exercise it was observed that the processes for acquiring low level information, such as processes or memory information does not represents an extensive load on the actual system that is processing the task. However, it is expected that the amount of demanded resources increase as the number of SCADA tags and the frequency of logging increases. Therefore on real live SCADA system, the acquisition process could be competing for resources that should be available for the normal operation of the SCADA systems.
